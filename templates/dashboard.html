{% extends 'index.html' %}
{% block title %}Dashboard - CRM Pro{% endblock %}
{% block content %}
    <title>CRM Dashboard - Analytics & Insights</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <h1>Dashboard</h1>
                    <p class="subtitle">Welcome back! Here's your real estate activity overview.</p>
                </div>
                <div class="header-actions">
                    <div class="date-range">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        <select id="dateRange" onchange="updateDateRange()">
                            <option value="7">Last 7 days</option>
                            <option value="30" selected>Last 30 days</option>
                            <option value="90">Last 90 days</option>
                            <option value="365">Last year</option>
                        </select>
                    </div>
                    <button class="btn-icon" onclick="refreshDashboard()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"></path>
                        </svg>
                    </button>
                    <button class="btn-primary" onclick="window.location.href='leads.html'">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Add New Lead
                    </button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <section class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <div class="metric-header">
                            <span class="metric-label">Active Leads</span>
                            <span class="metric-change positive" id="leadsChange">+12%</span>
                        </div>
                        <div class="metric-value" id="totalLeads">0</div>
                        <div class="metric-footer">
                            <span id="newLeadsToday">0</span> new today
                        </div>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                            <polyline points="9 22 9 12 15 12 15 22"></polyline>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <div class="metric-header">
                            <span class="metric-label">Properties Listed</span>
                            <span class="metric-change positive" id="propertiesChange">+8%</span>
                        </div>
                        <div class="metric-value" id="totalProperties">0</div>
                        <div class="metric-footer">
                            <span id="activeListings">0</span> active listings
                        </div>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <div class="metric-header">
                            <span class="metric-label">Deals Closed</span>
                            <span class="metric-change positive" id="dealsChange">+15%</span>
                        </div>
                        <div class="metric-value" id="closedDeals">0</div>
                        <div class="metric-footer">
                            <span id="thisMonthDeals">0</span> this month
                        </div>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
                            <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <div class="metric-header">
                            <span class="metric-label">Scheduled Viewings</span>
                            <span class="metric-change positive" id="viewingsChange">+22%</span>
                        </div>
                        <div class="metric-value" id="scheduledViewings">0</div>
                        <div class="metric-footer">
                            <span id="todayViewings">0</span> today
                        </div>
                    </div>
                </div>
            </section>

            <section class="charts-row">
                <div class="chart-card large">
                    <div class="chart-header">
                        <div>
                            <h3>Lead Activity Trends</h3>
                            <p class="chart-subtitle">Daily lead generation and conversion</p>
                        </div>
                        <div class="chart-actions">
                            <button class="chart-btn active" data-period="daily">Daily</button>
                            <button class="chart-btn" data-period="weekly">Weekly</button>
                            <button class="chart-btn" data-period="monthly">Monthly</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="activityChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <div>
                            <h3>Pipeline Status</h3>
                            <p class="chart-subtitle">Leads by stage</p>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="pipelineChart"></canvas>
                    </div>
                    <div class="pipeline-legend" id="pipelineLegend"></div>
                </div>
            </section>

            <section class="analytics-row">
                <div class="analytics-card">
                    <div class="analytics-header">
                        <h3>Property Types</h3>
                        <p class="analytics-subtitle">Distribution by property type</p>
                    </div>
                    <div class="property-types-list" id="propertyTypesList"></div>
                </div>

                <div class="analytics-card">
                    <div class="analytics-header">
                        <h3>Top Performing Agents</h3>
                        <p class="analytics-subtitle">By deals closed</p>
                    </div>
                    <div class="agents-list" id="topAgents"></div>
                </div>

                <div class="analytics-card">
                    <div class="analytics-header">
                        <h3>Upcoming Follow-ups</h3>
                        <p class="analytics-subtitle">Scheduled for next 7 days</p>
                    </div>
                    <div class="followups-list" id="upcomingFollowups"></div>
                </div>
            </section>

            <section class="performance-row">
                <div class="performance-card">
                    <div class="performance-header">
                        <h3>Lead Sources Performance</h3>
                        <p class="performance-subtitle">Conversion rate by source</p>
                    </div>
                    <div class="sources-performance" id="sourcesPerformance"></div>
                </div>

                <div class="performance-card">
                    <div class="performance-header">
                        <h3>Response Time Analysis</h3>
                        <p class="performance-subtitle">Average response time by priority</p>
                    </div>
                    <div class="response-analysis" id="responseAnalysis"></div>
                </div>
            </section>

            <section class="activity-section">
                <div class="activity-card">
                    <div class="activity-header">
                        <h3>Recent Activity Feed</h3>
                        <p class="activity-subtitle">Latest updates from your team</p>
                    </div>
                    <div class="activity-timeline" id="activityTimeline"></div>
                </div>

                <div class="tasks-card">
                    <div class="tasks-header">
                        <div>
                            <h3>Today's Tasks</h3>
                            <p class="tasks-subtitle">Your action items</p>
                        </div>
                        <button class="btn-secondary" onclick="addNewTask()">Add Task</button>
                    </div>
                    <div class="tasks-list" id="todayTasks"></div>
                </div>
            </section>

            <section class="quick-actions">
                <h3>Quick Actions</h3>
                <div class="actions-grid">
                    <button class="action-card" onclick="window.location.href='leads.html'">
                        <div class="action-icon" style="background: #eff6ff; color: #2563eb;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                        </div>
                        <div class="action-content">
                            <h4>Manage Leads</h4>
                            <p>View and organize all leads</p>
                        </div>
                    </button>

                    <button class="action-card" onclick="window.location.href='pipeline.html'">
                        <div class="action-icon" style="background: #f0fdf4; color: #10b981;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="8" y1="6" x2="21" y2="6"></line>
                                <line x1="8" y1="12" x2="21" y2="12"></line>
                                <line x1="8" y1="18" x2="21" y2="18"></line>
                                <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                <line x1="3" y1="18" x2="3.01" y2="18"></line>
                            </svg>
                        </div>
                        <div class="action-content">
                            <h4>Sales Pipeline</h4>
                            <p>Track deals through stages</p>
                        </div>
                    </button>

                    <button class="action-card" onclick="scheduleViewing()">
                        <div class="action-icon" style="background: #fef3c7; color: #f59e0b;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                        </div>
                        <div class="action-content">
                            <h4>Schedule Viewing</h4>
                            <p>Book property viewings</p>
                        </div>
                    </button>

                    <button class="action-card" onclick="window.location.href='reports.html'">
                        <div class="action-icon" style="background: #fae8ff; color: #a855f7;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                        </div>
                        <div class="action-content">
                            <h4>View Reports</h4>
                            <p>Detailed analytics & insights</p>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

  <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
